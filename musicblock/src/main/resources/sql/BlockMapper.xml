<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="BlockMapper">

	<resultMap type="Block" id="BlockSelectMap">
		<result property="bCode" column="bcode" jdbcType="INTEGER" />
		<result property="uCode" column="ucode" jdbcType="INTEGER" />
		<result property="note" column="note" jdbcType="VARCHAR" />
		<result property="emotion" column="emotion" jdbcType="INTEGER" />
		<result property="pCount" column="pcount" jdbcType="INTEGER" />
		<result property="dCount" column="dcount" jdbcType="INTEGER" />
		<collection property="blockHashList" javaType="java.util.List"
			resultMap="BlockHashResultMap" />
	</resultMap>

	<resultMap type="BlockHash" id="BlockHashResultMap">
		<result property="hCode" column="hcode" jdbcType="INTEGER" />
		<result property="bCode" column="hcode" jdbcType="INTEGER" />
		<result property="tag" column="tag" jdbcType="VARCHAR" />
	</resultMap>

	<!-- SQL : INSERT -->
	<insert id="addBlock" parameterType="block">
		INSERT
		INTO
		block(bcode,ucode,note,emotion,pcount,dcount )
		VALUES
		(SEQ_BLOCK_BCODE.NEXTVAL,1,#{note},#{emotion},0,0 )
	</insert>

	<!-- addBlockHash, forEach문 이용해서 하나씩 insert -->

	<insert id="addBlockHash" parameterType="BlockHash">
	
	INSERT
	INTO
	block_hash(hcode,bcode,tag)
	values (SEQ_BLOCK_HASH_HCODE.NEXTVAL,#{bcode},#{tag})

		<!-- <foreach item="item" index="index" collection="list" open="INSERT "
			close=" " separator=" ">

			INTO
			block_hash (hcode,bcode,tag )
			VALUES
			(SEQ_BLOCK_HASH_HCODE.NEXTVAL,#{item.bcode},#{item.tag})
		</foreach> -->
	</insert>

</mapper>